<!DOCTYPE html>
<html>
<head>
   <title>Quick Notes</title>
   <meta name="apple-mobile-web-app-capable" content="yes">
   <meta name="apple-mobile-web-app-status-bar-style" content="black">
   <meta name="format-detection" content="telephone=no">
   <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
   <link rel="stylesheet" href="css/style.css">
</head>

<body class="showing-notes">
   <script src="/js/ext/require.2.1.6.js"></script>
   <script>
      require.config({
         baseUrl: '/js/',
         urlArgs: 'release={{cacheBreaker}}',
         shim: {
            'jQuery': { exports: 'jQuery' }
         },
         paths: {
            jquery: 'ext/jquery-2.0.3.min'
         }
      });

      require(['notes', 'domain/notesmodel'], function(Notes, NotesModel) {
         var notes = new NotesModel().notes;
         alert('Got notes');
         var notesJson = JSON.stringify(notes);
         alert('Serialized notes');

         var formData = new FormData();
         formData.append("json", notesJson);

         jQuery.ajax({
            url: location.href,
            type: 'POST',
            data: formData,
            processData: false,
            success: function () {
               jQuery('body').html('Thank you, submission made.');
            },
            error: function () {
               jQuery('body').html('Oh no! submission failed.');
            }
         })
      });
   </script>
</body>
</html>
